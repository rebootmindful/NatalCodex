{
  "permissions": {
    "allow": [
      "Bash(git -C \"d:\\CC\\ncdesign\" add generate.html api/reports/generateWithAPImart.js lib/cache.js)",
      "Bash(git -C \"d:\\CC\\ncdesign\" commit -m \"$(cat <<''EOF''\nfeat: Add PDF Chinese support, history records, and API caching\n\nðŸ”§ PDF Chinese Font Support:\n- Switch to client-side PDF generation using html2pdf.js\n- Use system Chinese fonts (Microsoft YaHei, PingFang SC)\n- Add styled PDF layout with title, timestamp, and branding\n\nðŸ“š Report History Records:\n- Save generated reports to localStorage (max 10 records)\n- View, delete individual reports or clear all history\n- Auto-populate Soul Card data when viewing history\n- 30-day expiration for privacy\n\nâš¡ Performance Optimization:\n- Add in-memory cache for API responses (lib/cache.js)\n- Cache identical birth data requests for 10 minutes\n- Reduce API calls for repeated queries\n- Auto-cleanup to keep max 50 cached entries\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git add:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat: Xunhupay 2024 upgrade + admin orders + security fixes\n\n## Xunhupay Payment System (2024 API)\n- Upgrade to POST API (URL redirect deprecated Jan 2024)\n- Add QR code modal for PC payment with 5-min countdown\n- Add payment status polling every 3 seconds\n- Mobile auto-redirect to Alipay with return_url order param\n\n## Admin Panel - Order Management\n- Add new \"Orders\" tab with filtering (paid/pending/expired/failed)\n- Order search by order number\n- Display user email, package, amount, promo code, status\n\n## Security Enhancements\n- Order status API: JWT auth + owner-only full info\n- Rate limiting: 30 requests/minute per order\n- Auto-expire pending orders after 30 minutes\n\n## Bug Fixes\n- Fix pay/result.html API path and field mapping\n- Add 3-second auto-redirect after successful payment\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git push)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat: Add payment retry mechanism + fix admin JWT parsing\n\n## Payment Retry (æ”¯ä»˜å¤±è´¥é‡è¯•æœºåˆ¶)\n- Add QR code timeout error state with retry button\n- Add /api/pay?action=retry endpoint\n- Reuse pending orders within 30 min, create new for expired\n- Preserve original order amount and promo code on retry\n\n## Admin JWT Fix\n- Fix decoded.userId -> decoded.id in verifyAdmin()\n- Token uses ''id'' field, not ''userId'' (same fix as pay.js)\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git commit -m \"$(cat <<''EOF''\nfix: Admin token key mismatch (nc_token -> nc_auth_token)\n\ngenerate.html uses ''nc_auth_token'' but admin/index.html was reading\n''nc_token'', causing admin to always redirect to login page.\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git commit:*)"
    ],
    "deny": [],
    "ask": []
  }
}
